define("http://static.winxuancdn.com/libs/core/login.js",["jQuery","widgets-css","config"],function(a){var b=a("jQuery"),c=a("widgets-css"),d=a("config"),e={callbackUrl:"",LOADED_EVENT:"loaded",LOGINED_EVENT:"logined",iframeContent:'<!DOCTYPE HTML><html><head><title>登录小窗口</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><style type="text/css">body{font-size:12px;}body,p,ul,li,form a{margin:0;padding:0;text-decoration:none;}.login-form ul{list-style:none;}.login-form li.selected{display:block;}.login-form li{display:none;}.login-form p{clear:both;height:24px;line-height:24px;margin:10px 0;}.login-form input{width:170px;border:1px solid #ccc;padding:4px;float:left;}.login-form label{margin:0 10px;width:80px;display:block;width:60px;text-align:right;height:24px;float:left;}.login-form .buttonWrap a{margin:0 10px;color:#bfbfbf;}.login-form .buttonWrap button{height:29px;width:67px;border:none;background:url(http://static.winxuancdn.com/css2/images/detail-bg.png) no-repeat -302px -67px;color:#fff;}form .buttonWrap span{display:none;}form.loading .buttonWrap span{display:block;position:absolute;left:50px;width:20px;height:20px;background:url('+d.portalServer+'/css/images/loading_16x16.gif) no-repeat center;} .login-form .buttonWrap {margin:10px 0;position:relative;padding:0 0 0 80px;}.login-form .info{text-align:center;}</style></head><body><form action="http://passport.winxuan.com/login" method="post" target="hidenIframe"><input type="hidden" name="redirectUrl" value=""/><div class="login-form"><p><label for="name">帐户名</label><input type="text" name="name"/></p><p><label for="password">密　码</label><input type="password" name="password"/></p><div class="buttonWrap"><span></span><button>登录</button><a href="http://passport.winxuan.com/findPassword" target="_blank">忘记密码？</a></div><div class="info">还不是文轩网用户？<a href="http://passport.winxuan.com/register?returnUrl='+encodeURIComponent(document.URL)+'" target="shoppingcart">马上注册</a></div></div></form><iframe name="hidenIframe" style="display:none;"></iframe></body></html>',template:'<div class="widgets-window mini-login" id="miniLogin" style="display:none;"><div class="widgets-title"><ul><li class="selected">请先登录</li><li>使用手机/其它帐号</li></ul><a href="javascript:;">X</a></div><div class="widgets-content"><iframe name="loginFrame" frameborder="0"></iframe></div></div>',isLogin:function(){b.ajax({url:d.portalServer+"/customer/status?mode=2&format=jsonp&callback=?",success:function(a){b(e).trigger(e.LOADED_EVENT,[a])},global:!1,dataType:"jsonp"})},miniLogin:function(){if(b("#miniLogin").length==0){b(this.template).appendTo(document.body);var a=window.frames.loginFrame.document;a.write(this.iframeContent),a.close(),this.doc=b(a)}this.el=b("#miniLogin"),this.init()},init:function(){this.el.find(".widgets-title a").click(function(){e.el.hide()}),this.doc.find("button").click(e.submit)},submit:function(a){var c=e.doc.find("form"),d=c.attr("action"),f=c.find("input[name='redirectUrl']");if(f.length==0)try{f=b("<input type='hidden' name='redirectUrl' value='"+e.callbackUrl+"'/>"),f.appendTo(c)}catch(g){alert(g.message)}else f.val(e.callbackUrl);return c.submit(),c.find(":input").attr("disabled","disabled"),c.addClass("loading"),a.preventDefault(),a.stopPropagation(),!1},show:function(a){this.el||this.miniLogin(),this.locate(a),this.doc.find(":disabled").removeAttr("disabled"),this.el.show()},locate:function(a){if(!!a){var c=b(a).offset();this.el.css({top:c.top-b(a).height()-this.el.height(),left:c.left-this.el.width()+b(a).width()})}},hide:function(){e.doc.find(":disabled").removeAttr("disabled"),e.doc.find("form").removeClass("loading"),this.el.hide()},callback:function(a,c){a=="1"?(b(e).trigger(e.LOGINED_EVENT),this.hide()):(e.doc.find(":disabled").removeAttr("disabled"),e.doc.find("form").removeClass("loading"),alert(c))}};return e});